### 개략적 설계안
- 데이터모델
  - 지표데이터는 통상 시계열 형태로 기록
  - 대부분 행 프로토콜을 따른다.
- 데이터 접근 패턴
  - 지속적으로 막대한 쓰기 부하, 순간적인 읽기 부하
- 데이터 저장소 시스템
  - 다른 디비보다 시계열 전용 데이터베이스 사용 추천
 
### 상세 설계
#### 지표 수집
- 풀 모델 (TCP)
  - 모든 엔드포인트를 담은 파일을 두면 가장 간단하지만 확장성에 문제가 있음
  - 주키퍼 같은 서비스 탐색 기술을 활용
  - 사전 합의된 HTTP 엔드포인트를 통해 지표 수집
  - 안정해시를 통한 지표 수집기 풀 운용
- 푸시 모델 (UDP)
  - 지표 출처에서 직접 지표 수집기에 전송
  - 통상 수집 에이전트로 불리는 소프트웨어 설치
  - 지표수집기 클러스터 앞단에 로드밸런서 가용
- 서로의 장단점을 잘 비교해서 선택하는것이 중요

### 지표 전송 파이프라인의 규모 확장
- 모델에 관계없이 지표수집기는 클러스터 형태
- 데이터 손실방지를 위해 큐 도입
- 파티션 매커니즘으로 확장에 용이

### 데이터 집계 지점
- 수집 에이전트
  - 트래픽을 줄이지만 복잡한 집계로직은 힘듬.
- 데이터수집 파이프라인
  - 데이터양을 줄이지만 원본이 아니라서 정밀도/유연성 측면에서 손해
- 질의 시점
  - 원본 그대로 보관하지만 집계결과 계산에 느림
 
### 질의 서비스
- 질의 서버 클러스터 형태로 구현

### 저장소 계층
- 시계열 데이터베이스는 신중하게 선택
- 데이터를 인코딩 및 압축해서 보관
- 데이터의 해상도를 낮춰(다운샘플링) 저장소 요구량 줄이기
- cold storage 활용

### 경보 시스템
- 설정파일을 캐시서버에 보관해 참조
- 카산드라같은 키-값 저장소에 보관
- 카프카를 통해 경보 이벤트 생성/소비
- 하지만 이미 시장에 시계열 디비와 통합된 경보시스템이 많음

### 시각화 시스템
- 그라파타 같이 상용품은 이미 많이 존재


















### 스트리밍 vs 일괄 처리
- 람다 아키텍처: 일괄처리와 스트리밍 처리 경로를 동시에 지원하는 아키텍처
- 카파 아키텍처: 일괄처리와 스트리밍 처리 경로를 하나로 결합하는 아키텍처
  - 단일 스트림 처리 엔진을 사용해 실시간 데이터 처리및 재처리 문제를 모두 해결

### 데이터 재계산 (데이터 재처리)
- 재계산 프로세스는 집계 서비스를 이용하지만 처리대상을 원시 데이터에서 직접 읽는다.

### 시간
- 광고 클릭 시간과 집계 서버가 클릭 이벤트를 처리한 시스템 시각에서 생성됨
- 지연등의 문제로 이벤트 발생시각을 사용할것을 추천
  - 워터마크: 집계 윈도의 확장, 크기는 비즈니스 요구사항에 맞춤
    - 데이터 정확도는 늘어나지만 지연시간도 늘어난다.

### 집계 윈도
- 텀블링 윈도: 시간을 같은 크기의 겹치지 않는 구간으로 분할
- 슬라이딩 윈도: 데이터 스트림을 미끄러져 나가면서 같은 시간 구간안에 있는 이벤트를 집계

### 전달 보장
- 메시지큐의 3가지 전달유형 중 정확히 한번 채택
- 집계 결과 전송, 오프셋 저장, 수신 확인 응답 전송을 하나의 분산 트랜잭션으로 묶어야 한다.

### 시스템 규모 확장
- 메시지 큐
  - 생산자: 그냥 확장하면 됨
  - 소비자: 소비자 그룹 내 재조정
- 브로커
  - 해시 키로 이벤트 id 사용
  - 사전에 충분한 파티션 확보
  - 토픽의 물리적 샤딩
- 집계 서비스
  - 노드의 추가/삭제를 통한 수평 확장
 
### 핫스팟 문제
- 수신하는 데이터가 많은 노드에 더 많은 서비스 노드 할당

### 결함 내성
- 업스트림 오프셋 같은 시스템 상태를 스냅샷으로 저장하고 마지막 저장부터 복구해 나간다.

### 데이터 모니터링 및 정확성
- 시스템 주용 부분마다 시각추적, 시각 사이의 차이를 모니터링
- 카프카의 경우 레코드 처리 지연지표를 추적
- 시스템 자원 모니터링
